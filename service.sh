#!/system/bin/sh
MODDIR=${0%/*}

sleep 15

settings put global adb_enabled 0

settings put global development_settings_enabled 0

# 删除 模块文件夹
rm -rf /data/adb/modules/most-vip/apk
rm -rf /data/adb/modules/most-vip/Cone

# 开机后自动禁用 DM-Verity 和启动校检
avbctl disable-verity --force
avbctl disable-verification --force

sh /data/adb/modules/most-vip/删除target游戏包名.sh

#!/system/bin/sh

# 目标配置文件路径
CONFIG_FILE="/data/user/0/org.frknkrc44.hma_oss/files/config.json"

# 隐藏应用列表配置内容
NEW_CONFIG='{"configVersion":93,"detailLog":false,"errorOnlyLog":false,"maxLogSize":512,"forceMountData":true,"disableActivityLaunchProtection":false,"altAppDataIsolation":false,"altVoldAppDataIsolation":false,"skipSystemAppDataIsolation":true,"packageQueryWorkaround":false,"templates":{"莫晨隐藏环境v7.0.0":{"isWhitelist":false,"appList":["com.bwnc.zcj","com.uusense.speed","chunqiu.safe.detector","com.feilun.main","Han.GJZS","com.dijia1124.plusplusbattery","com.example.myapplication","wu.keyChain.test","tmgp.atlas.toolbox","com.time.tools","web1n.stopapp","org.akanework.checker","com.daxiaamu.op7mutools","com.surcumference.fingerprintpay","icu.nullptr.applistdetector","com.youhu.laifu","net.fusionapp","org.frknkrc44.hma_oss","me.garfieldhan.holmes","com.guoshi.httpcanary","com.zhenxi.hunter","com.github.capntrips.kernelflasher","io.github.a13e300.ksuwebui","com.lingqing.detector","luna.safe.luna","io.github.huskydg.memorydetector","io.github.vvb2060.mahoshojo","com.reveny.nativecheck","icu.nullptr.nativetest","com.github.dan.NoStorageRestrict","com.godevelopers.OprekCek","com.byxiaorun.detector","com.sukisu.ultra","org.telegram.messenger.web","com.virb3.trustmealready","li.songe.gkd","myapp.jiagu","hbjx.igljd.dmkdgpl","uto.dtuezank.vyg","gdo.pgqhiu.blcysrb.xdjcgc.ojftshx","ch.nlzuxwqr.xadwutv","com.shinegirls.RemoveSharePopup","com.tsng.applistdetector","com.example.application","sqq.zaurli.xybovn","aidepro.top","com.fly.apkencryptor","com.reveny.vbmetafix.service","com.studio.duckdetector","com.fkjc.zcro","moe.shizuku.privileged.api","com.sky.wlyz","bin.mt.plus","bin.mt.termex","com.MTAPP","com.chuqniudetector","com.example.fjfjfjfjfj","com.xff.launch"]}},"settingsTemplates":{},"scope":{"chunqiu.safe.detector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","root_apps","shizuku_dhizuku","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.tencent.tmgp.pubgmhd":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.tencent.jkchess":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.sankuai.meituan":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.example.myapplication":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","root_apps","shizuku_dhizuku","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"wu.keyChain.test":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"org.akanework.checker":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.yitong.mbank.psbc":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":false,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","root_apps","shizuku_dhizuku","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"icu.nullptr.applistdetector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.youhu.laifu":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"me.garfieldhan.holmes":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":true,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","root_apps","shizuku_dhizuku","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.zhenxi.hunter":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","root_apps","shizuku_dhizuku","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.lingqing.detector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"luna.safe.luna":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"io.github.huskydg.memorydetector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.reveny.nativecheck":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"icu.nullptr.nativetest":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.godevelopers.OprekCek":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.byxiaorun.detector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.bilibili.studio":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","root_apps","shizuku_dhizuku","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.smile.gifmaker":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":false,"hideSystemInstallationSource":false,"excludeTargetInstallationSource":false,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options"],"extraAppList":[],"extraOppositeAppList":[]},"com.kuaishou.nebula":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.jingdong.app.mall":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.eg.android.AlipayGphone":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":false,"hideSystemInstallationSource":false,"excludeTargetInstallationSource":false,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options"],"extraAppList":[],"extraOppositeAppList":[]},"com.studio.duckdetector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.fkjc.zcro":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":false,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"myapp.jiagu":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":false,"hideSystemInstallationSource":false,"excludeTargetInstallationSource":false,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":[],"applyPresets":[],"applySettingTemplates":[],"applySettingsPresets":[],"extraAppList":[],"extraOppositeAppList":[]},"com.tsng.applistdetector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps","xposed"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.chuqniudetector":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"io.github.vvb2060.mahoshojo":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.xff.launch":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.kwai.videoeditor":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.xunmeng.pinduoduo":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.luna.music":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]},"com.ximalaya.ting.android":{"useWhitelist":false,"excludeSystemApps":true,"hideInstallationSource":true,"hideSystemInstallationSource":true,"excludeTargetInstallationSource":true,"invertActivityLaunchProtection":false,"excludeVoldIsolation":false,"restrictedZygotePermissions":[],"applyTemplates":["莫晨隐藏环境v7.0.0"],"applyPresets":["custom_rom","detector_apps","sus_apps"],"applySettingTemplates":[],"applySettingsPresets":["accessibility","dev_options","input_method"],"extraAppList":[],"extraOppositeAppList":[]}}}'

echo "$NEW_CONFIG" > "$CONFIG_FILE"
echo "隐藏应用列表配置成功！"


cp -rf /data/adb/modules/most-vip/keybox.xml /data/adb/tricky_store/keybox.xml

echo "keybox更新成功"



#!/bin/bash
PROPS=(
  "ro.boot.flash.locked=1" "ro.boot.verifiedbootstate=green"
  "ro.boot.vbmeta.device_state=locked"
  "ro.secureboot.lockstate=locked" "ro.boot.realmebootstate=green"
  "ro.boot.realme.lockstate=1" "ro.secure=1"
  "ro.adb.secure=1" "ro.build.type=user"
  "ro.build.tags=release-keys" "ro.warranty_bit=0"
  "ro.vendor.warranty_bit=0" "vendor.boot.vbmeta.device_state=locked"
  "vendor.boot.verifiedbootstate=green" "sys.oem_unlock_allowed=0"
)
for prop in "${PROPS[@]}"; do
  NAME=${prop%=*}
  EXPECTED=${prop#*=}
  [ "$(resetprop $NAME)" != "$EXPECTED" ] && resetprop $NAME $EXPECTED
done
if [ -n "$(settings get global hidden_api_policy 2>/dev/null)" ] || \
   [ -n "$(settings get global hidden_api_blacklist_exemptions 2>/dev/null)" ]; then
  settings delete global hidden_api_policy{,_p_apps,_pre_p_apps}
  settings delete global hidden_api_blacklist_exemptions{,s_exe} 2>/dev/null
fi
resetprop -n persist.logd.size{,,.crash,.main} ""
[ "$(getprop ro.crypto.state)" != "encrypted" ] && resetprop ro.crypto.state encrypted
IS_VM=0
[ -x "$(command -v dmidecode)" ] && dmidecode -s system-product-name | grep -qE "VMware|VirtualBox|KVM|QEMU" && IS_VM=1
[[ $(df -h /sdcard 2>/dev/null | awk 'NR==2 {print $3}' | sed 's/G$//') -le 10 ]] && IS_VM=1
[ "$(getenforce)" = "Permissive" ] && [ $IS_VM -eq 0 ] && setenforce 1
for boot_prop in "ro.bootmode" "ro.boot.bootmode" "vendor.boot.bootmode"; do
  [[ "$(resetprop $boot_prop)" = "recovery" ]] && resetprop $boot_prop unknown
done
